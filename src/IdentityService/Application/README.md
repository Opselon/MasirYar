# لایه Application

این لایه قلب منطق کسب‌وکار میکروسرویس `IdentityService` است. این لایه مسئولیت هماهنگی عملیات، اجرای قوانین کسب‌وکار و مدیریت جریان داده‌ها بین لایه `Api` و لایه `Infrastructure` را بر عهده دارد.

## مسئولیت‌ها

-   **پیاده‌سازی Use Cases:** این لایه شامل پیاده‌سازی تمام موارد استفاده (Use Cases) سیستم است، مانند ثبت‌نام کاربر، ورود کاربر و غیره.
-   **اجرای قوانین کسب‌وکار:** تمام قوانین و منطق کسب‌وکار در این لایه پیاده‌سازی می‌شوند تا از صحت و یکپارچگی داده‌ها اطمینان حاصل شود.
-   **هماهنگی عملیات:** این لایه به عنوان یک هماهنگ‌کننده عمل می‌کند و از سرویس‌های لایه `Infrastructure` برای انجام عملیات مربوط به داده‌ها و دیگر وابستگی‌های خارجی استفاده می‌کند.
-   **عدم وابستگی به جزئیات پیاده‌سازی:** این لایه هیچ وابستگی مستقیمی به نحوه پیاده‌سازی جزئیات فنی مانند پایگاه داده یا سرویس‌های خارجی ندارد و از طریق رابط‌ها (Interfaces) با آن‌ها در ارتباط است.

## ساختار

-   `UseCases`: این پوشه شامل تمام موارد استفاده سیستم است که بر اساس قابلیت‌ها (Features) گروه‌بندی شده‌اند. هر قابلیت شامل `Command` یا `Query` و `Handler` مربوط به خود است.
    -   **Commands:** برای عملیاتی که وضعیت سیستم را تغییر می‌ده دهند (مانند ایجاد، به‌روزرسانی یا حذف داده‌ها).
    -   **Queries:** برای عملیاتی که داده‌ها را از سیستم می‌خوانند بدون اینکه وضعیت آن را تغییر دهند.
    -   **Handlers:** شامل منطق اصلی برای پردازش `Commands` و `Queries` است.
-   `Interfaces`: این پوشه شامل رابط‌هایی است که توسط لایه `Infrastructure` پیاده‌سازی می‌شوند، مانند `IUserRepository` و `IPasswordHasher`. این رابط‌ها به لایه `Application` اجازه می‌دهруют تا بدون وابستگی به جزئیات پیاده‌سازی، با لایه‌های دیگر در ارتباط باشد.

## الگوی طراحی

این لایه از الگوی **CQRS (Command Query Responsibility Segregation)** با استفاده از کتابخانه `MediatR` بهره می‌برد. این الگو به جداسازی عملیات خواندن و نوشتن کمک می‌کند و باعث می‌شود که کد تمیزتر، قابل نگهداری‌تر و مقیاس‌پذیرتر باشد.
