---
sidebar_position: 5
---

# Infrastructure Layer

This layer contains the technical implementations and details related to the external dependencies of the `IdentityService` microservice. This layer acts as a bridge between the `Application` layer and the outside world.

## Responsibilities

-   **Data Access:** This layer includes the implementation of data access interfaces (such as `IUserRepository`). In this project, **Entity Framework Core** is used to communicate with the **PostgreSQL** database.
-   **Communication with External Services:** If the microservice needs to communicate with external services (such as email, SMS, or other APIs), the implementation of the corresponding clients is placed in this layer.
-   **Implementation of Application Layer Interfaces:** This layer is responsible for implementing the interfaces defined in the `Application` layer. For example, `UserRepository` in this layer implements the `IUserRepository` interface.

## Structure

-   `Persistence`: This folder contains all the code related to the database.
    -   `IdentityDbContext`: The main `DbContext` class that represents a session with the database and allows us to work with entities.
    -   `Migrations`: Contains the database migration codes generated by EF Core.
-   `Repositories`: This folder contains specific implementations of the Repository interfaces. For example, `UserRepository` contains the logic for accessing user data using `IdentityDbContext`.
-   `Services`: This folder contains the implementation of external services. For example, `PasswordHasher`, which implements the `IPasswordHasher` interface, is located in this folder.

## Design Principles

-   **Dependency Inversion Principle (DIP):** This layer adheres to the Dependency Inversion Principle. This means that this layer depends on the `Application` layer, not the other way around. This is achieved by implementing the interfaces defined in the `Application` layer.
-   **Separation of Concerns:** This layer helps in the separation of concerns, so that all details related to technical implementations are centralized in one place and separated from the business logic.
